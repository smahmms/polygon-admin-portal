(this["webpackJsonprilac-web"]=this["webpackJsonprilac-web"]||[]).push([[60],{2374:function(e,a,t){"use strict";t.r(a);var s=t(673),c=t(442),i=(t(620),t(448)),l=t(0),r=t(1720),o=t(1682),n=(t(1067),t(711)),d=t(440),h=t(461),b=t(432),j=t(465),g=t(450),u=t(451),m=t(452),p=t(449),O=t(1657),x=t(463),_=t(1680),f=t(1654),y=t(467),v=t(446),k=t(445),C=t(503),S=t(437),w=t(5);a.default=()=>{const e=JSON.parse(localStorage.getItem("userData")),[a,t]=Object(s.a)(),N=Object(n.g)(),I=Object(l.useRef)(),P=Object(l.useRef)(),B=Object(l.useRef)(),[M,R]=Object(l.useState)([]),[F,H]=Object(l.useState)(!1),[L,q]=Object(l.useState)(null),[D,T]=Object(l.useState)([]),[U,z]=Object(l.useState)(null),[A,J]=Object(l.useState)(!0),[V,E]=Object(l.useState)([]),[W,G]=Object(l.useState)([]),[K,Q]=Object(l.useState)({title:"",body:"",thumbnail_height:0,thumbnail_width:0,fb_adset_id:"",image_hash:"",link_url:"",image_url:"",image:"",effective_instagram_media_id:"",is_fb_page_post:!1,fb_page_post_category_ids:[],facebookpage_subcategory_localuids:[]}),X=e=>{Q({...K,[e.target.name]:e.target.value})};Object(l.useEffect)((()=>{(async()=>{await c.a.adRuleList().then((e=>{const a=[];for(const t of e.data.payload)!0===t.is_approved&&a.push(t);T(a.map((e=>({value:e.id,label:e.rule_name}))))})).catch((e=>{Object(S.a)(e)})),localStorage.setItem("usePMStoken",!1),localStorage.setItem("useBMStoken",!0),await c.a.campaignList().then((e=>{R(e.data),localStorage.setItem("useBMStoken",!1)})).catch((e=>{var a;401===(null===(a=e.response)||void 0===a?void 0:a.status)?(localStorage.setItem("BMSCall",!0),c.a.getBMStoken({username:C.f,password:C.d}).then((e=>{localStorage.setItem("BMStoken",e.data.jwtToken),localStorage.setItem("BMSCall",!1),J(!A)})).catch((e=>{localStorage.setItem("BMSCall",!1)}))):(Object(S.a)(e),localStorage.setItem("useBMStoken",!1))})),localStorage.setItem("usePMStoken",!1),localStorage.setItem("useBMStoken",!1),c.a.getFbpageCategory().then((e=>{E(e.data.payload.map((e=>({value:{id:e.uid,subcategory:e.subcategory},label:null===e||void 0===e?void 0:e.name}))))})).catch((e=>{Object(S.a)(e)}))})()}),[A]);return Object(w.jsxs)(l.Fragment,{children:[Object(w.jsx)(b.a.Ripple,{className:"mb-1",color:"primary",tag:d.b,to:"vendor"===(null===e||void 0===e?void 0:e.role)?"/adlistVendor":"/adlist",children:Object(w.jsxs)("div",{className:"d-flex align-items-center",children:[Object(w.jsx)(r.a,{size:17,style:{marginRight:"5px"}}),Object(w.jsx)("span",{children:"Back"})]})}),Object(w.jsxs)(j.a,{style:{width:"100%"},onSubmit:a=>{a.preventDefault(),H(!0);const{title:t,body:s,thumbnail_height:i,thumbnail_width:l,fb_adset_id:r,link_url:o,image_url:n,image:d,effective_instagram_media_id:h,image_hash:b,campaign_id:j,is_fb_page_post:g,fb_page_post_category_ids:u,facebookpage_subcategory_localuids:m}=K,p=new FormData;p.append("image",L),c.a.singleFileupload(p).then((async a=>{await c.a.createAd({title:t,body:s,thumbnail_height:i,thumbnail_width:l,fb_adset_id:r,link_url:o,image_url:n,image:await a.data.payload.image_url,effective_instagram_media_id:h,image_hash:b,campaign_id:j,is_fb_page_post:g,fb_page_post_category_ids:u,facebookpage_subcategory_localuids:m}).then((a=>{H(!1),Object(S.c)(a),N.push("vendor"===(null===e||void 0===e?void 0:e.role)?"/adlistVendor":"/adlist")})).catch((e=>{H(!1),Object(S.a)(e),console.log(e.response)}))})).catch((e=>{console.log(e.response),H(!1)}))},autoComplete:"off",children:[Object(w.jsx)("h4",{className:"m-1",children:"AD Info"}),Object(w.jsxs)(g.a,{className:"match-height",children:[Object(w.jsx)(u.a,{sm:"6",children:Object(w.jsx)(m.a,{children:Object(w.jsx)(p.a,{children:Object(w.jsxs)(g.a,{children:[Object(w.jsx)(u.a,{sm:"12",children:Object(w.jsxs)(O.a,{children:[Object(w.jsxs)(x.a,{for:"title",children:["Title",Object(w.jsx)("span",{className:"text-danger",children:"*"})]}),Object(w.jsx)(_.a,{type:"text",name:"title",id:"title",value:K.title,onChange:X,required:!0,placeholder:"title here..."})]})}),Object(w.jsx)(u.a,{sm:"12",children:Object(w.jsxs)(O.a,{children:[Object(w.jsxs)(x.a,{for:"body",children:["Body",Object(w.jsx)("span",{className:"text-danger",children:"*"})]}),Object(w.jsx)(_.a,{type:"textarea",rows:"4",name:"body",id:"body",value:K.body,onChange:X,required:!0,placeholder:"body"})]})})]})})})}),Object(w.jsxs)(u.a,{sm:"6",children:[Object(w.jsx)(m.a,{children:Object(w.jsx)(p.a,{children:Object(w.jsxs)(g.a,{children:[Object(w.jsxs)(u.a,{sm:"12",children:[Object(w.jsxs)(O.a,{children:[Object(w.jsxs)(x.a,{for:"type",children:["AD Rule",Object(w.jsx)("span",{style:{color:"red"},children:"*"})]}),Object(w.jsx)(h.a,{ref:I,theme:i.i,maxMenuHeight:200,className:"react-select",classNamePrefix:"select",onChange:e=>{Q({...K,fb_adset_id:e.value})},options:D,menuPlacement:"auto"})]}),Object(w.jsx)(_.a,{required:!0,style:{opacity:0,width:"100%",height:0},onFocus:e=>I.current.select.focus(),value:K.fb_adset_id||"",onChange:e=>""})]}),Object(w.jsxs)(u.a,{sm:"12",children:[Object(w.jsxs)(O.a,{children:[Object(w.jsxs)(x.a,{for:"type",children:["Select Campaign",Object(w.jsx)("span",{style:{color:"red"},children:"*"})]}),Object(w.jsx)(h.a,{ref:B,theme:i.i,maxMenuHeight:200,className:"react-select",classNamePrefix:"select",onChange:e=>{Q({...K,campaign_id:e.value})},options:M.map((e=>({value:e.id,label:e.campaignName}))),menuPlacement:"auto"})]}),Object(w.jsx)(_.a,{required:!0,style:{opacity:0,width:"100%",height:0},onFocus:e=>B.current.select.focus(),value:K.campaign_id||"",onChange:e=>""})]})]})})}),"`"]})]}),Object(w.jsx)(m.a,{children:Object(w.jsx)(p.a,{children:Object(w.jsxs)(g.a,{children:[Object(w.jsx)(u.a,{sm:"4",children:Object(w.jsx)(O.a,{children:Object(w.jsx)(f.a,{type:"switch",onChange:e=>{e.target.checked?Q({...K,is_fb_page_post:!0}):(Q({...K,is_fb_page_post:!1}),G([]))},id:"is_fb_page_post",label:"Is Facebook Page Post?",checked:K.is_fb_page_post})})}),K.is_fb_page_post&&Object(w.jsx)(u.a,{md:"4",sm:"6",children:Object(w.jsxs)(O.a,{children:[Object(w.jsxs)(x.a,{for:"fb_page_post_category_ids",children:["Facebook Page Category ",Object(w.jsx)("span",{style:{color:"red"},children:"*"})]}),V.length?Object(w.jsx)(h.a,{ref:P,theme:i.i,className:"basic-multi-select",classNamePrefix:"select",name:"businesscategories",options:V,onChange:e=>(e=>{if(0===e.length)G([]),Q({...K,fb_page_post_category_ids:[]});else{const a=[];for(const t of e)for(const e of t.value.subcategory)a.push(e);G(a),Q({...K,fb_page_post_category_ids:e.map((e=>e.value.id))})}})(e),isMulti:!0,isClearable:!1}):Object(w.jsx)(y.a,{color:"primary"}),Object(w.jsx)(_.a,{required:!0,style:{opacity:0,width:"100%",height:0},onFocus:e=>P.current.select.focus(),value:K.fb_page_post_category_ids||"",onChange:e=>""})]})}),0!==(null===W||void 0===W?void 0:W.length)&&Object(w.jsx)(u.a,{sm:"4",children:Object(w.jsxs)(O.a,{children:[Object(w.jsx)(x.a,{for:"facebookpage_subcategory_localuid",children:"Facebook Page Sub Category"}),Object(w.jsx)(h.a,{theme:i.i,maxMenuHeight:200,className:"react-select",classNamePrefix:"select",onChange:e=>(e=>{Q({...K,facebookpage_subcategory_localuids:e.map((e=>e.value))})})(e),isMulti:!0,isClearable:!1,options:null===W||void 0===W?void 0:W.map((e=>({value:e.uid,label:e.name})))})]})})]})})}),Object(w.jsxs)(m.a,{children:[Object(w.jsx)(v.a,{className:"border-bottom",children:Object(w.jsx)(k.a,{tag:"h4",children:"Image info"})}),Object(w.jsx)(p.a,{style:{paddingTop:"15px"},children:Object(w.jsxs)(g.a,{children:[Object(w.jsx)(u.a,{sm:"6",children:Object(w.jsxs)(O.a,{children:[Object(w.jsx)(x.a,{for:"thumbnail_height",children:"Thumbnail Height"}),Object(w.jsx)(_.a,{type:"number",name:"thumbnail_height",id:"thumbnail_height",value:K.thumbnail_height,onChange:X,placeholder:"thumbnail height here..."})]})}),Object(w.jsx)(u.a,{sm:"6",children:Object(w.jsxs)(O.a,{children:[Object(w.jsx)(x.a,{for:"thumbnail_width",children:"Thumbnail Width"}),Object(w.jsx)(_.a,{type:"number",name:"thumbnail_width",id:"thumbnail_width",value:K.thumbnail_width,onChange:X,placeholder:"thumbnail width here..."})]})}),Object(w.jsx)(u.a,{sm:"6",children:Object(w.jsxs)(O.a,{children:[Object(w.jsx)(x.a,{for:"link_url",children:"Link URL"}),Object(w.jsx)(_.a,{type:"text",name:"link_url",id:"link_url",value:K.link_url,onChange:X,placeholder:"link url"})]})}),Object(w.jsx)(u.a,{sm:"6",children:Object(w.jsxs)(O.a,{children:[Object(w.jsx)(x.a,{for:"image_url",children:"Image URL"}),Object(w.jsx)(_.a,{type:"text",name:"image_url",id:"image_url",value:K.image_url,onChange:X,placeholder:"image url"})]})}),Object(w.jsxs)(u.a,{md:"12",className:"mb-2",children:[Object(w.jsx)(x.a,{for:"voucherImage",children:"Upload Image"}),Object(w.jsxs)("div",{className:"d-flex",children:[Object(w.jsxs)("div",{className:"file position-relative overflow-hidden mr-2",children:[Object(w.jsxs)("div",{className:"text-center p-1",style:{height:"102px",width:"102px",border:"1px dashed #d9d9d9",backgroundColor:"#fafafa"},children:[Object(w.jsx)("span",{children:Object(w.jsx)(o.a,{size:20,className:"my-1"})})," ",Object(w.jsx)("br",{}),Object(w.jsx)("span",{children:"Upload"})]}),Object(w.jsx)(_.a,{style:{position:"absolute",opacity:"0",left:"0",top:"0",height:"102px",width:"102px",cursor:"pointer"},type:"file",accept:"image/png, image/jpeg",required:!0,name:"voucherImage",id:"voucherImage",onChange:e=>{0!==e.target.files.length&&z(URL.createObjectURL(e.target.files[0])),q(e.target.files[0]),(e=>{H(!0);const a=new FormData;a.append("filename",e),c.a.getImageHash(a).then((e=>{let a;for(const t in e.data.payload.images)a=e.data.payload.images[t].hash;Q({...K,image_hash:a}),H(!1)})).catch((e=>{Object(S.a)(e),H(!1)}))})(e.target.files[0])}})]}),U&&Object(w.jsx)("img",{src:U,alt:"voucher img",height:"100px"})]})]})]})})]}),Object(w.jsx)(m.a,{children:Object(w.jsx)(p.a,{children:Object(w.jsx)(g.a,{children:Object(w.jsx)(u.a,{sm:"12",className:"text-center",children:F?Object(w.jsxs)(b.a.Ripple,{color:"primary",className:"mr-1",disabled:!0,children:[Object(w.jsx)(y.a,{color:"white",size:"sm"}),Object(w.jsx)("span",{className:"ml-50",children:"Loading..."})]}):Object(w.jsx)(b.a.Ripple,{className:"ml-2",color:"primary",type:"submit",children:Object(w.jsx)("span",{children:"Submit"})})})})})})]})]})}},437:function(e,a,t){"use strict";t.d(a,"a",(function(){return c})),t.d(a,"b",(function(){return i})),t.d(a,"c",(function(){return l}));t(0);var s=t(107);const c=e=>{try{const a=e.response;404===a.status||401===a.status||400===a.status||500===a.status||409===a.status?s.f.error(a.data.message,{position:"top-right",autoClose:5e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0}):s.f.error("The server is under maintenance",{position:"top-right",autoClose:5e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0})}catch(a){s.f.error("Please check your connection",{position:"top-right",autoClose:5e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0})}},i=e=>{try{const a=e.response;404!==a.status&&401!==a.status&&400!==a.status||s.f.error(a.data.errors?a.data.errors[Object.keys(a.data.errors)[0]]:a.data.message,{position:"top-right",autoClose:5e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0})}catch(a){s.f.error("Please check your connection",{position:"top-right",autoClose:5e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0})}},l=e=>{const a=e.data.message||"success";s.f.success(a,{position:"top-right",autoClose:5e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0})}},620:function(e,a,t){}}]);
//# sourceMappingURL=60.7393d015.chunk.js.map