(this["webpackJsonprilac-web"]=this["webpackJsonprilac-web"]||[]).push([[354],{2406:function(e,a,s){"use strict";s.r(a);var t=s(442),l=(s(495),s(448)),c=s(0),r=s(1720),n=s(711),i=s(440),o=s(461),d=s(432),j=s(452),u=s(446),h=s(445),b=s(465),m=s(449),O=s(450),x=s(451),p=s(1657),g=s(463),v=s(1680),f=s(1654),y=s(467),T=s(460),C=s.n(T),k=s(444),N=s.n(k),R=s(437),D=s(5);N()(C.a);a.default=()=>{const e=Object(n.g)(),a=Object(c.useRef)(),s=Object(c.useRef)(),T=Object(c.useRef)(),C=Object(c.useRef)(),k=Object(c.useRef)(),[N,S]=Object(c.useState)(!1),[P,M]=Object(c.useState)([]),[A,w]=Object(c.useState)({offlineRuleName:"",serviceId:"",offlineRuleMsg:"",noOfTran:0,minPerTran:0,isTotalTran:!1,tranOpsType:0,tranDays:1,userType:"",bonusAmount:0,isPercentage:!1,min:0,max:0,startDate:"",endDate:"",isExpiry:!0,isActive:!1,isPerTranBonus:!1,isSkdDatetime:!1,skdHour:0,skdTime:0}),B=e=>{w({...A,[e.target.name]:e.target.value})};Object(c.useEffect)((()=>{localStorage.setItem("useBMStoken",!1),t.a.getServiceList().then((e=>{console.log(e),M(e.data.payload),localStorage.setItem("useBMStoken",!1)})).catch((e=>{Object(R.a)(e),console.log(e),localStorage.setItem("useBMStoken",!1)}))}),[]);const H=e=>{let a=0,s=0,t=e;for(;t.match(/<TransactionTime>/)||t.match(/<TransactionId>/)||t.match(/<RewordAmount>/)||t.match(/<Msisdn>/)||t.match(/<TransactionAmount>/)||t.match(/<CampaignName>/);){var l,c;if(t.match(/<TransactionTime>/)&&(a+=19,s+=2,t=t.replace(/<TransactionTime>/,"")),t.match(/<TransactionId>/)&&(a+=30,s+=15,t=t.replace(/<TransactionId>/,"")),t.match(/<RewordAmount>/)&&(a+=10,s-=4,t=t.replace(/<RewordAmount>/,"")),t.match(/<Msisdn>/)&&(a+=11,s-=3,t=t.replace(/<Msisdn>/,"")),t.match(/<TransactionAmount>/)&&(a+=10,s-=9,t=t.replace(/<TransactionAmount>/,"")),t.match(/<CampaignName>/))s+=(null===A||void 0===A||null===(l=A.offlineRuleName)||void 0===l?void 0:l.length)-14,a+=null===A||void 0===A||null===(c=A.offlineRuleName)||void 0===c?void 0:c.length,t=t.replace(/<CampaignName>/,"")}return a+=t.length,{charCount:a,actualCharReduce:s}};return Object(D.jsxs)(c.Fragment,{children:[Object(D.jsx)(d.a.Ripple,{className:"mb-1",color:"primary",tag:i.b,to:"/allOfflineRules",children:Object(D.jsxs)("div",{className:"d-flex align-items-center",children:[Object(D.jsx)(r.a,{size:17,style:{marginRight:"5px"}}),Object(D.jsx)("span",{children:"Back"})]})}),Object(D.jsx)(j.a,{children:Object(D.jsx)(u.a,{className:"border-bottom",children:Object(D.jsx)(h.a,{tag:"h4",children:"Add Offline Campaign Rule"})})}),Object(D.jsxs)(b.a,{style:{width:"100%"},onSubmit:a=>{a.preventDefault(),localStorage.setItem("useBMStoken",!0);let{startDate:s,endDate:l}=A;s=s?s.replace(/T/," "):s,l=l?l.replace(/T/," "):l,S(!0),console.log({...A,startDate:s,endDate:l}),t.a.createOfflineRule({...A,startDate:s,endDate:l}).then((a=>{S(!1),localStorage.setItem("useBMStoken",!1),Object(R.c)(a),e.push("/allOfflineRules")})).catch((e=>{S(!1),localStorage.setItem("useBMStoken",!1),Object(R.a)(e),console.log(e.response)}))},autoComplete:"off",children:[Object(D.jsx)(j.a,{children:Object(D.jsx)(m.a,{children:Object(D.jsxs)(O.a,{children:[Object(D.jsx)(x.a,{sm:"6",children:Object(D.jsxs)(p.a,{children:[Object(D.jsxs)(g.a,{for:"offlineRuleName",children:["Campaign Rule Name",Object(D.jsx)("span",{style:{color:"red"},children:"*"})]}),Object(D.jsx)(v.a,{type:"text",name:"offlineRuleName",id:"offlineRuleName",value:A.offlineRuleName,onChange:B,required:!0,maxLength:"20",placeholder:"description here..."}),Object(D.jsxs)("p",{className:"text-right",style:20===A.offlineRuleName.length?{margin:"2px",color:"red"}:{margin:"2px",color:"blue"},children:[20-A.offlineRuleName.length," characters remaining"]})]})}),Object(D.jsx)(x.a,{sm:"6",children:Object(D.jsxs)(p.a,{children:[Object(D.jsxs)(g.a,{for:"offlineRuleMsg",children:["Offline Rule Message",Object(D.jsx)("span",{style:{color:"red"},children:"*"})]}),Object(D.jsx)(v.a,{type:"textarea",name:"offlineRuleMsg",id:"offlineRuleMsg",value:A.offlineRuleMsg,onChange:B,required:!0,placeholder:"message here...",maxLength:(160-H(A.offlineRuleMsg).actualCharReduce).toString()}),Object(D.jsxs)("p",{className:"text-right",style:160===H(A.offlineRuleMsg).charCount?{margin:"2px",color:"red"}:{margin:"2px",color:"blue"},children:[160-H(A.offlineRuleMsg).charCount," characters remaining"]})]})}),Object(D.jsx)(x.a,{sm:"5",children:Object(D.jsxs)(p.a,{children:[Object(D.jsxs)(g.a,{for:"serviceId",children:["Service Type",Object(D.jsx)("span",{style:{color:"red"},children:"*"})]}),Object(D.jsx)(o.a,{ref:a,theme:l.i,maxMenuHeight:200,className:"react-select",classNamePrefix:"select",onChange:e=>{w({...A,serviceId:e.value})},options:null===P||void 0===P?void 0:P.map((e=>({value:e.service_id,label:e.service_keyword})))}),Object(D.jsx)(v.a,{required:!0,style:{opacity:0,width:"100%",height:0},onFocus:e=>a.current.select.focus(),value:A.serviceId||"",onChange:e=>""})]})}),Object(D.jsx)(x.a,{sm:"4",children:Object(D.jsxs)(p.a,{children:[Object(D.jsxs)(g.a,{for:"userType",children:["Reward Receiver",Object(D.jsx)("span",{style:{color:"red"},children:"*"})]}),Object(D.jsx)(o.a,{ref:T,theme:l.i,maxMenuHeight:200,className:"react-select",classNamePrefix:"select",onChange:e=>{w({...A,userType:e.value})},options:[{value:"s",label:"Sender"},{value:"r",label:"Receiver"}]}),Object(D.jsx)(v.a,{required:!0,style:{opacity:0,width:"100%",height:0},onFocus:e=>T.current.select.focus(),value:A.userType||"",onChange:e=>""})]})}),Object(D.jsx)(x.a,{sm:"3",children:Object(D.jsxs)(p.a,{children:[Object(D.jsxs)(g.a,{for:"tranDays",children:["Rule Tenure",Object(D.jsx)("span",{style:{color:"red"},children:"*"})]}),Object(D.jsx)(o.a,{ref:s,theme:l.i,maxMenuHeight:200,className:"react-select",classNamePrefix:"select",defaultValue:{value:1,label:"Daily"},onChange:e=>{1===e.value?w({...A,skdTime:0,tranDays:e.value}):w({...A,tranDays:e.value})},options:[{value:1,label:"Daily"},{value:7,label:"Weekly"},{value:30,label:"Monthly"}]}),Object(D.jsx)(v.a,{required:!0,style:{opacity:0,width:"100%",height:0},onFocus:e=>s.current.select.focus(),value:A.tranDays||"",onChange:e=>""})]})}),Object(D.jsx)(x.a,{sm:"3",className:"mt-2",children:Object(D.jsx)(p.a,{children:Object(D.jsx)(f.a,{type:"switch",id:"isSkdDatetime",name:"isSkdDatetime",label:"Is Schedule?",onChange:e=>{e.target.checked?w({...A,isSkdDatetime:!0}):w({...A,isSkdDatetime:!1,skdTime:0,skdHour:0})}})})}),A.isSkdDatetime&&30===A.tranDays&&Object(D.jsx)(x.a,{md:"3",children:Object(D.jsxs)(p.a,{children:[Object(D.jsxs)(g.a,{for:"endTimeline",children:["Select a date",Object(D.jsx)("span",{style:{color:"red"},children:"*"})]}),Object(D.jsx)(o.a,{ref:k,theme:l.i,maxMenuHeight:200,className:"react-select",classNamePrefix:"select",onChange:e=>{w({...A,skdTime:e.value})},options:[{value:1,label:"1"},{value:2,label:"2"},{value:3,label:"3"},{value:4,label:"4"},{value:5,label:"5"},{value:6,label:"6"},{value:7,label:"7"},{value:8,label:"8"},{value:9,label:"9"},{value:10,label:"10"},{value:11,label:"11"},{value:12,label:"12"},{value:13,label:"13"},{value:14,label:"14"},{value:15,label:"15"},{value:16,label:"16"},{value:17,label:"17"},{value:18,label:"18"},{value:19,label:"19"},{value:20,label:"20"},{value:21,label:"21"},{value:22,label:"22"},{value:23,label:"23"},{value:24,label:"24"},{value:25,label:"25"},{value:26,label:"26"},{value:27,label:"27"},{value:28,label:"28"},{value:29,label:"29"},{value:30,label:"30"},{value:31,label:"31"}]}),Object(D.jsx)(v.a,{required:!0,style:{opacity:0,width:"100%",height:0},onFocus:e=>k.current.select.focus(),value:A.skdTime||"",onChange:e=>""})]})}),A.isSkdDatetime&&7===A.tranDays&&Object(D.jsx)(x.a,{md:"3",children:Object(D.jsxs)(p.a,{children:[Object(D.jsxs)(g.a,{for:"skdHour",children:["Select a day",Object(D.jsx)("span",{style:{color:"red"},children:"*"})]}),Object(D.jsx)(o.a,{ref:k,theme:l.i,maxMenuHeight:200,className:"react-select",classNamePrefix:"select",onChange:e=>{w({...A,skdTime:e.value})},options:[{value:6,label:"Saturday"},{value:7,label:"Sunday"},{value:1,label:"Monday"},{value:2,label:"Tuesday"},{value:3,label:"Wednesday"},{value:4,label:"Thursday"},{value:5,label:"Friday"}]}),Object(D.jsx)(v.a,{required:!0,style:{opacity:0,width:"100%",height:0},onFocus:e=>k.current.select.focus(),value:A.skdTime||"",onChange:e=>""})]})}),A.isSkdDatetime&&Object(D.jsx)(x.a,{md:"3",children:Object(D.jsxs)(p.a,{children:[Object(D.jsxs)(g.a,{for:"skdHour",children:["Hour",Object(D.jsx)("span",{style:{color:"red"},children:"*"})]}),Object(D.jsx)(v.a,{type:"number",name:"skdHour",min:"0",max:"24",id:"skdHour",value:A.skdHour,onChange:B,required:!0,placeholder:"0"})]})})]})})}),Object(D.jsx)(j.a,{children:Object(D.jsxs)(m.a,{children:[Object(D.jsxs)(O.a,{children:[Object(D.jsx)(x.a,{sm:"6",children:Object(D.jsxs)(p.a,{children:[Object(D.jsxs)(g.a,{for:"tranOpsType",children:["Rule Type",Object(D.jsx)("span",{style:{color:"red"},children:"*"})]}),Object(D.jsx)(o.a,{ref:C,theme:l.i,maxMenuHeight:200,className:"react-select",classNamePrefix:"select",onChange:e=>{w({...A,tranOpsType:e.value})},options:[{value:1,label:"Apply Rule on Transaction Count"},{value:0,label:"Apply Rule on Transaction Amount Limit"},{value:2,label:"Apply Rule on Both Transaction Count & Amount"}]}),Object(D.jsx)(v.a,{required:!0,type:"number",style:{opacity:0,width:"100%",height:0},onFocus:e=>C.current.select.focus(),value:0===A.tranOpsType?1:A.tranOpsType||"",onChange:e=>""})]})}),Object(D.jsx)(x.a,{sm:"6",className:"mt-1",children:Object(D.jsx)(p.a,{children:Object(D.jsx)(f.a,{type:"switch",id:"isPerTranBonus",name:"isPerTranBonus",label:"Is Bonus Per Transaction?",onChange:e=>{e.target.checked?w({...A,isPerTranBonus:!0}):w({...A,isPerTranBonus:!1})}})})})]}),Object(D.jsxs)(O.a,{className:"mt-2",children:[(1===A.tranOpsType||2===A.tranOpsType)&&Object(D.jsx)(x.a,{sm:"3",children:Object(D.jsxs)(p.a,{children:[Object(D.jsxs)(g.a,{for:"noOfTran",children:["MIN TXN Count",Object(D.jsx)("span",{style:{color:"red"},children:"*"})]}),Object(D.jsx)(v.a,{type:"number",name:"noOfTran",id:"noOfTran",value:A.noOfTran,onChange:B,required:!0,placeholder:"0"})]})}),(0===A.tranOpsType||2===A.tranOpsType)&&Object(D.jsx)(x.a,{sm:"3",children:Object(D.jsxs)(p.a,{children:[Object(D.jsxs)(g.a,{for:"minPerTran",children:["MIN Amount(TK)/TXN",Object(D.jsx)("span",{style:{color:"red"},children:"*"})]}),Object(D.jsx)(v.a,{type:"number",name:"minPerTran",id:"minPerTran",value:A.minPerTran,onChange:B,required:!0,placeholder:"0"})]})}),2===A.tranOpsType&&Object(D.jsx)(x.a,{sm:"3",className:"pt-2",children:Object(D.jsx)(p.a,{check:!0,children:Object(D.jsx)(f.a,{onChange:e=>{e.target.checked?w({...A,isTotalTran:!0}):w({...A,isTotalTran:!1})},label:"On Total Amount?",type:"checkbox",id:"isTotalTran"})})})]})]})}),Object(D.jsxs)(O.a,{children:[Object(D.jsx)(x.a,{sm:"6",children:Object(D.jsx)(j.a,{children:Object(D.jsx)(m.a,{children:Object(D.jsxs)(O.a,{children:[Object(D.jsxs)(x.a,{sm:"12",className:"mb-1",children:[Object(D.jsx)(g.a,{className:"d-block",children:Object(D.jsx)("h6",{children:"Type"})}),Object(D.jsx)(p.a,{check:!0,inline:!0,className:"mr-3",children:Object(D.jsxs)(g.a,{check:!0,children:[Object(D.jsx)(f.a,{type:"radio",id:"flat",name:"flat",checked:!A.isPercentage,onChange:()=>{w({...A,isPercentage:!1,min:0,max:0})}})," Flat"]})}),Object(D.jsx)(p.a,{check:!0,inline:!0,children:Object(D.jsxs)(g.a,{check:!0,children:[Object(D.jsx)(f.a,{type:"radio",id:"percentage",name:"percentage",checked:A.isPercentage,onChange:()=>{w({...A,isPercentage:!0})}})," Percentage"]})})]}),Object(D.jsx)(x.a,{sm:"4",children:Object(D.jsxs)(p.a,{children:[Object(D.jsxs)(g.a,{for:"bonusAmount",children:["Amount",Object(D.jsx)("span",{style:{color:"red"},children:"*"})]}),Object(D.jsx)(v.a,{type:"number",name:"bonusAmount",id:"bonusAmount",value:A.bonusAmount,onChange:B,required:!0,placeholder:"0"})]})}),A.isPercentage&&Object(D.jsx)(x.a,{sm:"4",children:Object(D.jsxs)(p.a,{children:[Object(D.jsxs)(g.a,{for:"min",children:["Min",Object(D.jsx)("span",{style:{color:"red"},children:"*"})]}),Object(D.jsx)(v.a,{type:"number",name:"min",id:"min",value:A.min,onChange:B,required:!0,placeholder:"0"})]})}),A.isPercentage&&Object(D.jsx)(x.a,{sm:"4",children:Object(D.jsxs)(p.a,{children:[Object(D.jsxs)(g.a,{for:"max",children:["Max",Object(D.jsx)("span",{style:{color:"red"},children:"*"})]}),Object(D.jsx)(v.a,{type:"number",name:"max",id:"max",value:A.max,onChange:B,required:!0,placeholder:"0"})]})})]})})})}),Object(D.jsx)(x.a,{sm:"6",children:Object(D.jsx)(j.a,{children:Object(D.jsxs)(m.a,{children:[Object(D.jsxs)(O.a,{children:[Object(D.jsx)(x.a,{md:"6",children:Object(D.jsxs)(p.a,{children:[Object(D.jsxs)(g.a,{for:"startDate",children:["Start Date",Object(D.jsx)("span",{style:{color:"red"},children:"*"})]}),Object(D.jsx)(v.a,{type:"datetime-local",min:(new Date).toLocaleDateString("fr-CA"),name:"startDate",id:"startDate",value:A.startDate,onChange:e=>{w({...A,startDate:e.target.value})},required:!0,placeholder:"0"})]})}),Object(D.jsx)(x.a,{md:"6",children:Object(D.jsxs)(p.a,{children:[Object(D.jsxs)(g.a,{for:"endDate",children:["End Date",Object(D.jsx)("span",{style:{color:"red"},children:"*"})]}),Object(D.jsx)(v.a,{type:"datetime-local",min:(new Date).toLocaleDateString("fr-CA"),name:"endDate",id:"endDate",value:A.endDate,onChange:e=>{w({...A,endDate:e.target.value})},required:!0,placeholder:"0"})]})})]}),Object(D.jsx)(x.a,{sm:"4",className:"mt-1",children:Object(D.jsx)(p.a,{children:Object(D.jsx)(f.a,{type:"switch",id:"isActive",name:"isActive",label:"isActive?",onChange:e=>{e.target.checked?w({...A,isActive:!0}):w({...A,isActive:!1})}})})})]})})})]}),Object(D.jsx)(x.a,{sm:"12",className:"text-center",children:N?Object(D.jsxs)(d.a.Ripple,{color:"primary",className:"mr-1",disabled:!0,style:{marginTop:"25px"},children:[Object(D.jsx)(y.a,{color:"white",size:"sm"}),Object(D.jsx)("span",{className:"ml-50",children:"Loading..."})]}):Object(D.jsx)(d.a.Ripple,{className:"ml-2",color:"primary",type:"submit",style:{marginTop:"25px"},children:Object(D.jsx)("span",{children:"Submit"})})})]})]})}},437:function(e,a,s){"use strict";s.d(a,"a",(function(){return l})),s.d(a,"b",(function(){return c})),s.d(a,"c",(function(){return r}));s(0);var t=s(107);const l=e=>{try{const a=e.response;404===a.status||401===a.status||400===a.status||500===a.status||409===a.status?t.f.error(a.data.message,{position:"top-right",autoClose:5e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0}):t.f.error("The server is under maintenance",{position:"top-right",autoClose:5e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0})}catch(a){t.f.error("Please check your connection",{position:"top-right",autoClose:5e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0})}},c=e=>{try{const a=e.response;404!==a.status&&401!==a.status&&400!==a.status||t.f.error(a.data.errors?a.data.errors[Object.keys(a.data.errors)[0]]:a.data.message,{position:"top-right",autoClose:5e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0})}catch(a){t.f.error("Please check your connection",{position:"top-right",autoClose:5e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0})}},r=e=>{const a=e.data.message||"success";t.f.success(a,{position:"top-right",autoClose:5e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0})}},495:function(e,a,s){}}]);
//# sourceMappingURL=354.7c9bdb8b.chunk.js.map