(this["webpackJsonprilac-web"]=this["webpackJsonprilac-web"]||[]).push([[353],{1554:function(e,t,a){"use strict";var s=a(442),c=a(448),r=a(0),n=a(1694),o=a(1804),l=a(461),i=a(452),d=a(465),j=a(450),m=a(451),b=a(644),u=a(463),h=a(1680),p=a(1657),O=a(1678),x=a(1679),y=a(1319),g=a(432),v=a(467),C=a(1654),N=a(460),f=a.n(N),S=a(444),k=a.n(S),w=a(437),_=a(5);k()(f.a);t.a=e=>{const{setConditionalRendering:t,showCompanyName:a,setshowCompanyName:N,continueBtn:f,setcontinueBtn:S}=e,[k,B]=Object(r.useState)({...JSON.parse(localStorage.getItem("registration_data")),isnewaccount:!0,isibn:!1,accountnumber:"",sortcode:"",accountholdername:"",isneedmorethenonepersontoauth:!1,addpaymentid:0,payment_method_id:1,sub_type:"monthly"}),[I,E]=Object(r.useState)({email:!1,address:!1,accountNumber:!1,sortcode:!1}),[P,M]=Object(r.useState)(!1),[q,A]=Object(r.useState)(!1),[Y,R]=Object(r.useState)(!0),[T,H]=Object(r.useState)(!1),[z,D]=Object(r.useState)(!1),[J,F]=Object(r.useState)([]),[L,K]=Object(r.useState)([]),[V,W]=Object(r.useState)(!1),[G,U]=Object(r.useState)([]),Q=e=>{if("email"===e.target.name){const t=/\S+@\S+\.\S+/.test(e.target.value),a={...I};a.email=!t,E({...a})}if("sortcode"===e.target.name){const t={...I};6!==e.target.value.length?t.sortcode=!0:t.sortcode=!1,E({...t})}if("accountnumber"===e.target.name){const t={...I};8!==e.target.value.length?t.accountNumber=!0:t.accountNumber=!1,E({...t})}B({...k,[e.target.name]:e.target.value})};return Object(_.jsx)("div",{className:"m-0",children:Object(_.jsx)(i.a,{children:Object(_.jsx)(d.a,{className:"p-2",style:{width:"100%"},onSubmit:e=>{e.preventDefault();const{accountnumber:t,address:a,city:c,email:r,firstname:n,lastname:o,postcode:l,sortcode:i,accountholdername:d}=k,j={...I};j.address=!a,E({...j}),!a||I.email||I.sortcode||I.accountNumber||(W(!0),s.a.customerBusinessRegistration({...k}).then((e=>{window.location.href=e.data.payload.payment_url})).catch((e=>{W(!1),Object(w.a)(e.response),console.log(e.response)})))},autoComplete:"off",children:Object(_.jsxs)(j.a,{children:[!!G.length&&Object(_.jsx)(m.a,{md:"12",children:Object(_.jsx)(b.a,{color:"danger",className:"p-1",children:Object(_.jsx)("ul",{children:G.map(((e,t)=>Object(_.jsx)("li",{children:"".concat(e.message)},t)))})})}),Object(_.jsxs)(m.a,{md:"4",className:"mb-1",children:[Object(_.jsx)(u.a,{children:a?"Company name":"First Name"}),a?Object(_.jsx)(h.a,{required:!0,placeholder:"Your Company Name",type:"text",name:"companyname",value:k.companyname,onChange:Q}):Object(_.jsx)(h.a,{required:!0,placeholder:"Firstname",type:"text",name:"firstname",value:k.firstname,onChange:Q})]}),!a&&Object(_.jsxs)(m.a,{md:"4",className:"mb-1",children:[Object(_.jsx)(u.a,{children:"Last Name"}),Object(_.jsx)(h.a,{required:!0,placeholder:"Lastname",type:"text",name:"lastname",value:k.lastname,onChange:Q})]}),Object(_.jsxs)(m.a,{md:"4",className:"mb-1",children:[Object(_.jsx)(u.a,{children:"Email"}),Object(_.jsx)(h.a,{required:!0,placeholder:"Your Email",type:"email",name:"email",value:k.email,onChange:Q}),I.email&&Object(_.jsx)("small",{style:{color:"red"},children:"Please enter a valid email"})]}),Object(_.jsxs)(m.a,{md:"4",className:"mb-1",children:[Object(_.jsx)(u.a,{children:"Account Holder Name"}),Object(_.jsx)(h.a,{required:!0,placeholder:"Account Holder Name",type:"text",name:"accountholdername",value:k.accountholdername,onChange:Q,disabled:!k.isnewaccount})]}),Object(_.jsxs)(m.a,{md:"4",className:"mb-1",children:[Object(_.jsxs)(u.a,{children:[k.isibn&&"IBAN"," Sort Code"]}),Object(_.jsx)(h.a,{required:!0,placeholder:"Sort Code",type:"number",name:"sortcode",value:k.sortcode,onChange:Q,disabled:!k.isnewaccount}),I.sortcode&&Object(_.jsx)("small",{style:{color:"red"},children:"must be 6 character"})]}),Object(_.jsxs)(m.a,{md:"4",className:"mb-1",children:[Object(_.jsxs)(u.a,{children:[k.isibn?"IBAN":"Account Number"," "]}),Object(_.jsx)(h.a,{required:!0,placeholder:"Account Number",type:"number",name:"accountnumber",value:k.accountnumber,onChange:Q,disabled:!k.isnewaccount}),I.accountNumber&&Object(_.jsx)("small",{style:{color:"red"},children:"must be 8 character"})]}),Object(_.jsxs)(m.a,{md:"12",children:[Object(_.jsx)("hr",{}),Object(_.jsx)(i.a,{children:Object(_.jsxs)(j.a,{children:[Object(_.jsx)(m.a,{md:"4",children:Object(_.jsxs)(p.a,{children:[Object(_.jsxs)(u.a,{for:"postcode",children:["Post Code",Object(_.jsx)("span",{style:{color:"red"},children:"*"})]}),Object(_.jsxs)(O.a,{className:"input-group-merge mb-1",children:[Object(_.jsx)(x.a,{addonType:"prepend",children:Object(_.jsx)(y.a,{children:Object(_.jsx)(n.a,{size:14})})}),Object(_.jsx)(h.a,{type:"text",name:"postcode",id:"postcode",placeholder:"Post Code",value:k.postcode,onChange:Q,required:!0}),Object(_.jsx)(x.a,{addonType:"append",children:z?Object(_.jsx)(g.a,{style:{paddingBottom:"9px"},color:"primary",outline:!0,disabled:!0,children:Object(_.jsx)(v.a,{color:"primary",size:"sm"})}):Object(_.jsx)(g.a,{color:"primary",outline:!0,onClick:()=>{k.postcode&&(D(!0),F([]),B({...k,address:"",country:"",city:""}),s.a.ukAddressEndpoint({postCode:k.postcode}).then((e=>{const{addresses:t}=e.data.payload;t.length?A(!1):A(!0),R(!0);const a=t.map(((e,t)=>({value:t,label:e.formatted_address.filter((e=>e)).splice(0,1).toString()})));D(!1),F(a),K(t)})).catch((e=>{D(!1),Object(w.a)(e),A(!0)})))},children:"Search"})}),Object(_.jsx)("div",{className:"p-0 m-0 w-100",children:q&&!T&&Object(_.jsx)("small",{style:{color:"red"},children:" postcode notfound"})}),Object(_.jsx)("div",{className:"p-0 m-0 w-100",children:T&&Object(_.jsx)("small",{style:{color:"red"},children:" postcode must be 6 to 8 character"})})]}),q&&Object(_.jsx)(C.a,{type:"checkbox",id:"postcode1",value:"CPC",onChange:e=>{B({...k,country:"",address:"",city:""}),e.target.checked?R(!1):R(!0)},inline:!0,label:"Click here to enter your address manually"})]})}),Object(_.jsx)(m.a,{md:"3",sm:"12",children:Object(_.jsxs)(p.a,{children:[Object(_.jsxs)(u.a,{for:"address",children:["Address ",Object(_.jsx)("span",{style:{color:"red"},children:"*"})]}),J.length?Object(_.jsx)(l.a,{styles:{control:(e,t)=>({...e,borderColor:"#7367f0"})},maxMenuHeight:150,theme:c.i,className:"react-select",classNamePrefix:"select",name:"address",required:!0,onChange:e=>{const t=+e.value;B({...k,address:e.label,country:L[t].country,city:L[t].town_or_city})},options:J,isClearable:!1}):Object(_.jsx)(h.a,{type:"text",required:!0,onChange:Q,value:k.address,disabled:Y,name:"address",placeholder:"Address"}),I.address&&!k.address&&Object(_.jsx)("small",{style:{color:"red"},children:"Address is required"})]})}),Object(_.jsx)(m.a,{md:"3",sm:"12",children:Object(_.jsxs)(p.a,{children:[Object(_.jsxs)(u.a,{for:"country",children:["Country ",Object(_.jsx)("span",{style:{color:"red"},children:"*"})]}),Object(_.jsx)(h.a,{onChange:Q,type:"text",required:!0,name:"country",value:k.country,disabled:Y,id:"country",placeholder:"Country"})]})}),Object(_.jsx)(m.a,{md:"2",sm:"12",children:Object(_.jsxs)(p.a,{children:[Object(_.jsxs)(u.a,{for:"city",children:["City ",Object(_.jsx)("span",{style:{color:"red"},children:"*"})]}),Object(_.jsx)(h.a,{onChange:Q,type:"text",required:!0,name:"city",value:k.city,disabled:Y,id:"city",placeholder:"City"})]})})]})})]}),Object(_.jsx)(m.a,{md:"12",children:Object(_.jsx)("small",{children:"You may cancel this Direct Debit at any time by contacting Rilac or your bank"})}),Object(_.jsx)(m.a,{md:"12",className:"text-center",children:V?Object(_.jsxs)(g.a.Ripple,{className:"ml-2",color:"primary",disabled:!0,style:{marginTop:"22px"},children:[Object(_.jsx)(v.a,{size:"sm"}),Object(_.jsx)("span",{className:"align-middle ml-50",children:"Loading..."})]}):Object(_.jsxs)(g.a.Ripple,{className:"ml-2",color:"primary",style:{marginTop:"22px"},type:"submit",children:[Object(_.jsx)(o.a,{size:15}),Object(_.jsx)("span",{className:"align-middle ml-50",children:"Submit"})]})})]})})})})}},1644:function(e,t,a){"use strict";var s=a(622),c=a(442),r=a(109),n=(a(632),a(448)),o=(a(52),a(0)),l=a(574),i=a(108),d=a(711),j=a(440),m=a(467),b=(a(111),a(1115)),u=a(1116),h=a(485),p=a(1734),O=a(1804),x=a(107),y=a(465),g=a(450),v=a(451),C=a(1657),N=a(463),f=a(432),S=a(814),k=a(503),w=a(5);const _=e=>{let{name:t,role:a}=e;return Object(w.jsxs)(o.Fragment,{children:[Object(w.jsx)("div",{className:"toastify-header",children:Object(w.jsxs)("div",{className:"title-wrapper",children:[Object(w.jsx)(h.a,{size:"sm",color:"success",icon:Object(w.jsx)(p.a,{size:12})}),Object(w.jsxs)("h6",{className:"toast-title font-weight-bold",children:["Welcome, ",t]})]})}),Object(w.jsx)("div",{className:"toastify-body",children:Object(w.jsxs)("span",{children:["You have successfully logged in as an ",a," user to system. Now you can start to explore. Enjoy!"]})})]})};var B=()=>{const e=Object(o.useContext)(r.a),[t,j]=Object(s.a)(),u=Object(d.g)(),h=Object(i.b)(),{register:p,errors:B,handleSubmit:I,trigger:E}=Object(l.c)(),[P,M]=Object(o.useState)({}),[q,A]=Object(o.useState)({}),[Y,R]=Object(o.useState)(""),[T,H]=Object(o.useState)(!1),[z,D]=Object(o.useState)(0),[J,F]=Object(o.useState)(!1),L=Object(b.useStripe)(),K=Object(b.useElements)(),V=(Object(o.useRef)(null),{style:{base:{lineHeight:"27px",color:"#212529",fontSize:"1.1rem","::placeholder":{color:"#aab7c4"}},invalid:{color:"#fa755a",iconColor:"#fa755a"}}}),[W,G]=Object(o.useState)({...JSON.parse(localStorage.getItem("registration_data")),card_name:"",card_number:"",card_address:"",card_expiry:"",card_cvc:"",paymentMethodId:"",payment_method_id:2,sub_type:"monthly"}),U="dark"===t?"register-v2-dark.svg":"register-v2.svg";a(709)("./".concat(U)).default;return Object(w.jsx)("div",{className:"",children:Object(w.jsx)(y.a,{action:"/",className:"auth-register-form",onSubmit:async t=>{if(t.preventDefault(),H(!0),!L||!K)return void H(!1);const a={type:"card",card:K.getElement(b.CardNumberElement)};await L.createPaymentMethod(a).then((async t=>{const a=async t=>{if(t.error)H(!1),alert(t.error);else if(t.requiresAction){const{error:e,paymentIntent:s}=await L.handleCardAction(t.clientSecret);e?(H(!1),alert(e)):c.a.payByStripe({paymentIntentId:null===s||void 0===s?void 0:s.id}).then((async e=>{const t=e.data.payload;a(t)})).catch((e=>{Error(e)}))}else{H(!1),console.log(t.payload.data);const a={...t.payload.data.user_info,accessToken:t.payload.data.token,refreshToken:t.payload.data.token,extras:{eCommerceCartItemsCount:5},role:"vendor",ability:[{action:"manage",subject:"VENDOR"},{action:"manage",subject:"Auth"}]};h(Object(S.a)(a)),e.update(a.ability),x.f.success(Object(w.jsx)(_,{name:a.username,role:a.role}),{transition:x.c,hideProgressBar:!0,autoClose:2e3}),localStorage.setItem("usePMStoken",!1),localStorage.setItem("BMSCall",!0),await c.a.getBMStoken({username:k.f,password:k.d}).then((e=>{localStorage.setItem("BMStoken",e.data.jwtToken),localStorage.setItem("BMSCall",!1)})).catch((e=>{localStorage.setItem("BMSCall",!1)})),await c.a.customerbusinesslistbymobileno({mobile:Number(t.payload.data.user_info.mobileno)}).then((e=>{localStorage.setItem("customerBusinesses",JSON.stringify(e.data.payload)),u.push(Object(n.d)(a.role))})).catch((e=>{Error(e)}))}};await c.a.customerBusinessRegistration({...W,paymentMethodId:t.paymentMethod.id}).then((async e=>{const t=e.data.payload;a(t)})).catch((e=>{H(!1),Error(e.response),console.log(e.response)}))})).catch((e=>{console.log(e)}))},children:Object(w.jsxs)(g.a,{children:[Object(w.jsx)(v.a,{sm:"12",children:Object(w.jsxs)(C.a,{children:[Object(w.jsx)(N.a,{className:"form-label",for:"businessname",children:"Card Number"}),Object(w.jsx)(b.CardNumberElement,{type:"text",value:W.card_number,placeholder:"1234****",id:"cc-number",name:"businessname",options:V,onBlur:()=>{}})]})}),Object(w.jsx)(v.a,{sm:"6",children:Object(w.jsxs)(C.a,{children:[Object(w.jsx)(N.a,{className:"form-label",for:"card-expiry",children:"Card Expiry"}),Object(w.jsx)(b.CardExpiryElement,{type:"text",value:W.card_expiry,placeholder:"MM/YYYY",id:"expiry",name:"expiry",options:V})]})}),Object(w.jsx)(v.a,{sm:"6",children:Object(w.jsxs)(C.a,{children:[Object(w.jsx)(N.a,{className:"form-label",for:"businessname",children:"CVC"}),Object(w.jsx)(b.CardCvcElement,{type:"text",value:W.card_cvc,placeholder:"MM/YYYY",id:"cvc",name:"cvc",options:V})]})}),Object(w.jsx)(v.a,{md:"12",className:"text-center",children:T?Object(w.jsxs)(f.a.Ripple,{className:"ml-2",color:"primary",disabled:!0,style:{marginTop:"22px"},children:[Object(w.jsx)(m.a,{size:"sm"}),Object(w.jsx)("span",{className:"align-middle ml-50",children:"Loading..."})]}):Object(w.jsxs)(f.a.Ripple,{className:"ml-2",color:"primary",style:{marginTop:"22px"},type:"submit",children:[Object(w.jsx)(O.a,{size:15}),Object(w.jsx)("span",{className:"align-middle ml-50",children:"Submit"})]})})]})})})};t.a=()=>{Object(o.useContext)(r.a);const[e,t]=Object(s.a)(),{register:n,errors:h,handleSubmit:p,trigger:O}=(Object(d.g)(),Object(i.b)(),Object(l.c)()),[x,y]=Object(o.useState)({}),[g,v]=Object(o.useState)({}),[C,N]=Object(o.useState)(""),[f,S]=Object(o.useState)(!1),[k,_]=Object(o.useState)(0),I=Object(o.useRef)(null),[E,P]=Object(o.useState)({...JSON.parse(localStorage.getItem("registration_data")),payment_method_id:2});Object(o.useEffect)((async()=>{c.a.stripeData().then((async e=>{const t=e.data.payload;N(Object(u.a)(t.publishableKey)),S(!0)})).catch((e=>{Error(e)})),_(parseFloat(50))}),[]);const M="dark"===e?"register-v2-dark.svg":"register-v2.svg";a(709)("./".concat(M)).default;return Object(w.jsx)("div",{className:"",children:f?Object(w.jsxs)(b.Elements,{stripe:C,children:[Object(w.jsx)(B,{amount:k,childFunc:I}),Object(w.jsxs)("p",{className:"text-center mt-2",children:[Object(w.jsx)("span",{className:"mr-25",children:"Already have an account?"}),Object(w.jsx)(j.b,{to:"/login",children:Object(w.jsx)("span",{children:"Sign in instead"})})]})]}):Object(w.jsx)("div",{className:"d-flex justify-content-center",children:Object(w.jsx)(m.a,{className:"mt-5"})})})}},2492:function(e,t,a){"use strict";a.r(t);var s=a(0),c=a(452),r=a(449),n=a(543),o=a(1692),l=a(1693),i=a(546),d=a(547),j=(a(111),a(1644)),m=a(1554),b=a(5);t.default=()=>{const[e,t]=Object(s.useState)("1"),a=e=>t(e),u=JSON.parse(localStorage.getItem("registration_data"));return Object(b.jsx)(c.a,{style:{maxWidth:"768px"},className:"mx-auto my-4",children:Object(b.jsxs)(r.a,{className:"pt-2",children:[Object(b.jsxs)(n.a,{pills:!0,className:"border-bottom pb-1",children:[Object(b.jsx)(o.a,{children:Object(b.jsx)(l.a,{active:"1"===e,onClick:()=>a("1"),children:Object(b.jsx)("span",{className:"align-middle d-none d-sm-block",children:"Credit Card Details"})})}),"UK"===u.country&&Object(b.jsx)(o.a,{children:Object(b.jsx)(l.a,{active:"2"===e,onClick:()=>a("2"),children:Object(b.jsx)("span",{className:"align-middle d-none d-sm-block",children:"Go-Cardless Details"})})})]}),Object(b.jsxs)(i.a,{activeTab:e,children:[Object(b.jsx)(d.a,{tabId:"1",children:Object(b.jsx)(j.a,{})}),Object(b.jsx)(d.a,{tabId:"2",children:Object(b.jsx)(m.a,{})})]})]})})}},437:function(e,t,a){"use strict";a.d(t,"a",(function(){return c})),a.d(t,"b",(function(){return r})),a.d(t,"c",(function(){return n}));a(0);var s=a(107);const c=e=>{try{const t=e.response;404===t.status||401===t.status||400===t.status||500===t.status||409===t.status?s.f.error(t.data.message,{position:"top-right",autoClose:5e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0}):s.f.error("The server is under maintenance",{position:"top-right",autoClose:5e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0})}catch(t){s.f.error("Please check your connection",{position:"top-right",autoClose:5e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0})}},r=e=>{try{const t=e.response;404!==t.status&&401!==t.status&&400!==t.status||s.f.error(t.data.errors?t.data.errors[Object.keys(t.data.errors)[0]]:t.data.message,{position:"top-right",autoClose:5e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0})}catch(t){s.f.error("Please check your connection",{position:"top-right",autoClose:5e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0})}},n=e=>{const t=e.data.message||"success";s.f.success(t,{position:"top-right",autoClose:5e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0})}}}]);
//# sourceMappingURL=353.37a0c404.chunk.js.map