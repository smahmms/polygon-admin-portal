(this["webpackJsonprilac-web"]=this["webpackJsonprilac-web"]||[]).push([[282],{2490:function(e,s,t){"use strict";t.r(s);t(485);var a=t(577),o=t(622),r=t(442),n=t(475),c=t(803),i=t(109),l=t(814),d=(t(632),t(448)),u=t(52),g=t.n(u),p=t(0),m=t(574),h=t(108),b=t(711),j=t(440),f=t(450),O=t(451),v=t(445),w=t(504),x=t(465),y=t(1657),k=t(463),N=t(1680),T=t(432),C=t(467),M=t(111),S=t(1156),P=t(437),A=t(5);s.default=()=>{const[e,s]=Object(o.a)(),u=Object(p.useContext)(i.a),B=Object(h.b)(),[I,z]=(Object(b.g)(),Object(p.useState)("")),[E,L]=Object(p.useState)(""),[F,_]=Object(p.useState)(!1),[H,R]=Object(p.useState)({}),{register:D,errors:q,handleSubmit:G}=Object(m.c)(),J=localStorage.getItem("previousLocation")||null,U=localStorage.getItem("previousRole")||null,V="dark"===e?"login-v2-dark.svg":"login-v2.svg",W=t(709)("./".concat(V)).default;Object(p.useEffect)((async()=>{localStorage.clear()}),[]);return Object(A.jsx)("div",{className:"auth-wrapper auth-v2",children:Object(A.jsxs)(f.a,{className:"auth-inner m-0",children:[Object(A.jsx)(j.b,{className:"brand-logo",to:"/",onClick:e=>e.preventDefault(),children:Object(A.jsx)("img",{width:"80px",src:M.a})}),Object(A.jsx)(O.a,{className:"d-none d-lg-flex align-items-center p-5",lg:"8",sm:"12",children:Object(A.jsx)("div",{className:"w-100 d-lg-flex align-items-center justify-content-center px-5",children:Object(A.jsx)("img",{className:"img-fluid",src:W,alt:"Login V2"})})}),Object(A.jsx)(O.a,{className:"d-flex align-items-center auth-bg px-2 p-lg-5",lg:"4",sm:"12",children:Object(A.jsxs)(O.a,{className:"px-xl-2 mx-auto",sm:"8",md:"6",lg:"12",children:[Object(A.jsx)(v.a,{tag:"h2",className:"font-weight-bold mb-1",children:"Welcome to Rilac \ud83d\udc4b"}),Object(A.jsx)(w.a,{className:"mb-2",children:"Please sign-in to your account and start the adventure"}),Object(A.jsxs)(x.a,{className:"auth-login-form mt-2",onSubmit:G((e=>{const s=e.loginemail,t=e["login-password"];Object(d.f)(q)&&(_(!0),r.a.login({username:s,password:t}).then((async e=>{var t,a,o,r,i;const[d,g]=await Promise.all([c.a.login().then((e=>e.data)).catch((e=>(console.log("BMS ",e),null))),n.a.AdminUsersAssignedMenus({accessToken:e.data.payload.token}).then((e=>e.data.payload)).catch((e=>[]))]),p=(parseInt(e.data.payload.user_info.roleid),{...e.data.payload.user_info,fullname:"",avatar:"https://i.imgur.com/P4b2RHh.png",accessToken:e.data.payload.token,refreshToken:e.data.payload.refresh_token,extras:{eCommerceCartItemsCount:5},role:"admin",ability:[{action:"manage",subject:"ADMIN"},{action:"manage",subject:"Auth"}]});if(!d)return Object(P.a)({response:{status:401,data:{message:"Bms service is not connected!"}}}),_(!1),0;if(!g.length)return Object(P.a)({response:{status:401,data:{message:"Didn't find any assign menu permission for you. Please contact with system admin."}}}),_(!1),0;localStorage.setItem("useBMStoken",!1),localStorage.setItem("BMSCall",!1),localStorage.setItem("BMStoken",d.jwtToken),localStorage.setItem("AssignedMenus",JSON.stringify(g)),localStorage.setItem("username",s);const m=null!==(t=S.a.find((e=>e.id===g[0].id)))&&void 0!==t&&t.navLink?null===(a=S.a.find((e=>e.id===g[0].id)))||void 0===a?void 0:a.navLink:null===(o=S.a.find((e=>e.id===g[0].id)))||void 0===o||null===(r=o.children[0])||void 0===r?void 0:r.navLink;e.data.payload.password_added_at_before<=(null===(i=e.data.payload.passwordconfig)||void 0===i?void 0:i.expire_date_length)?(await B(Object(l.a)(p)),await u.update(p.ability),window.location.href=U===(null===p||void 0===p?void 0:p.role)&&J?J:m):(localStorage.setItem("accessToken",e.data.payload.token),localStorage.setItem("link",m),window.location.href="/resetPass")})).catch((e=>{_(!1),Object(P.a)(e),console.log("login error",e.response)})))})),autoComplete:"off",children:[Object(A.jsxs)(y.a,{children:[Object(A.jsx)(k.a,{className:"form-label",for:"login-email",children:"User Name"}),Object(A.jsx)(N.a,{autoFocus:!0,type:"text",id:"login-email",name:"loginemail",placeholder:"username",onChange:e=>z(e.target.value),className:g()({"is-invalid":q["login-email"]}),innerRef:D({required:!0,validate:e=>""!==e})})]}),Object(A.jsxs)(y.a,{children:[Object(A.jsx)("div",{className:"d-flex justify-content-between",children:Object(A.jsx)(k.a,{className:"form-label",for:"login-password",children:"Password"})}),Object(A.jsx)(a.a,{id:"login-password",name:"login-password",onChange:e=>L(e.target.value),className:g()("input-group-merge",{"is-invalid":q["login-password"]}),innerRef:D({required:!0,validate:e=>""!==e&&e.length>5})}),Object(A.jsx)("span",{style:{color:"red"},children:q["login-password"]&&"Valid password required"}),Object(A.jsx)("span",{style:{color:"red"},children:H.password})]}),F?Object(A.jsxs)(T.a.Ripple,{color:"primary",block:!0,disabled:!0,children:[Object(A.jsx)(C.a,{color:"white",size:"sm"}),Object(A.jsx)("span",{className:"ml-50",children:"Loading..."})]}):Object(A.jsx)(T.a.Ripple,{type:"submit",color:"primary",block:!0,children:"Sign in"}),Object(A.jsx)("br",{})]})]})})]})})}},437:function(e,s,t){"use strict";t.d(s,"a",(function(){return o})),t.d(s,"b",(function(){return r})),t.d(s,"c",(function(){return n}));t(0);var a=t(107);const o=e=>{try{const s=e.response;404===s.status||401===s.status||400===s.status||500===s.status||409===s.status?a.f.error(s.data.message,{position:"top-right",autoClose:5e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0}):a.f.error("The server is under maintenance",{position:"top-right",autoClose:5e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0})}catch(s){a.f.error("Please check your connection",{position:"top-right",autoClose:5e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0})}},r=e=>{try{const s=e.response;404!==s.status&&401!==s.status&&400!==s.status||a.f.error(s.data.errors?s.data.errors[Object.keys(s.data.errors)[0]]:s.data.message,{position:"top-right",autoClose:5e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0})}catch(s){a.f.error("Please check your connection",{position:"top-right",autoClose:5e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0})}},n=e=>{const s=e.data.message||"success";a.f.success(s,{position:"top-right",autoClose:5e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0})}},445:function(e,s,t){"use strict";var a=t(13),o=t(18),r=t(0),n=t.n(r),c=t(4),i=t.n(c),l=t(52),d=t.n(l),u=t(74),g={tag:u.tagPropType,className:i.a.string,cssModule:i.a.object},p=function(e){var s=e.className,t=e.cssModule,r=e.tag,c=Object(o.a)(e,["className","cssModule","tag"]),i=Object(u.mapToCssModules)(d()(s,"card-title"),t);return n.a.createElement(r,Object(a.a)({},c,{className:i}))};p.propTypes=g,p.defaultProps={tag:"div"},s.a=p},450:function(e,s,t){"use strict";var a=t(13),o=t(18),r=t(0),n=t.n(r),c=t(4),i=t.n(c),l=t(52),d=t.n(l),u=t(74),g=i.a.oneOfType([i.a.number,i.a.string]),p={tag:u.tagPropType,noGutters:i.a.bool,className:i.a.string,cssModule:i.a.object,form:i.a.bool,xs:g,sm:g,md:g,lg:g,xl:g},m={tag:"div",widths:["xs","sm","md","lg","xl"]},h=function(e){var s=e.className,t=e.cssModule,r=e.noGutters,c=e.tag,i=e.form,l=e.widths,g=Object(o.a)(e,["className","cssModule","noGutters","tag","form","widths"]),p=[];l.forEach((function(s,t){var a=e[s];if(delete g[s],a){var o=!t;p.push(o?"row-cols-"+a:"row-cols-"+s+"-"+a)}}));var m=Object(u.mapToCssModules)(d()(s,r?"no-gutters":null,i?"form-row":"row",p),t);return n.a.createElement(c,Object(a.a)({},g,{className:m}))};h.propTypes=p,h.defaultProps=m,s.a=h},451:function(e,s,t){"use strict";var a=t(13),o=t(18),r=t(0),n=t.n(r),c=t(4),i=t.n(c),l=t(52),d=t.n(l),u=t(74),g=i.a.oneOfType([i.a.number,i.a.string]),p=i.a.oneOfType([i.a.bool,i.a.number,i.a.string,i.a.shape({size:i.a.oneOfType([i.a.bool,i.a.number,i.a.string]),order:g,offset:g})]),m={tag:u.tagPropType,xs:p,sm:p,md:p,lg:p,xl:p,className:i.a.string,cssModule:i.a.object,widths:i.a.array},h={tag:"div",widths:["xs","sm","md","lg","xl"]},b=function(e,s,t){return!0===t||""===t?e?"col":"col-"+s:"auto"===t?e?"col-auto":"col-"+s+"-auto":e?"col-"+t:"col-"+s+"-"+t},j=function(e){var s=e.className,t=e.cssModule,r=e.widths,c=e.tag,i=Object(o.a)(e,["className","cssModule","widths","tag"]),l=[];r.forEach((function(s,a){var o=e[s];if(delete i[s],o||""===o){var r=!a;if(Object(u.isObject)(o)){var n,c=r?"-":"-"+s+"-",g=b(r,s,o.size);l.push(Object(u.mapToCssModules)(d()(((n={})[g]=o.size||""===o.size,n["order"+c+o.order]=o.order||0===o.order,n["offset"+c+o.offset]=o.offset||0===o.offset,n)),t))}else{var p=b(r,s,o);l.push(p)}}})),l.length||l.push("col");var g=Object(u.mapToCssModules)(d()(s,l),t);return n.a.createElement(c,Object(a.a)({},i,{className:g}))};j.propTypes=m,j.defaultProps=h,s.a=j},467:function(e,s,t){"use strict";var a=t(13),o=t(18),r=t(0),n=t.n(r),c=t(4),i=t.n(c),l=t(52),d=t.n(l),u=t(74),g={tag:u.tagPropType,type:i.a.string,size:i.a.string,color:i.a.string,className:i.a.string,cssModule:i.a.object,children:i.a.string},p=function(e){var s=e.className,t=e.cssModule,r=e.type,c=e.size,i=e.color,l=e.children,g=e.tag,p=Object(o.a)(e,["className","cssModule","type","size","color","children","tag"]),m=Object(u.mapToCssModules)(d()(s,!!c&&"spinner-"+r+"-"+c,"spinner-"+r,!!i&&"text-"+i),t);return n.a.createElement(g,Object(a.a)({role:"status"},p,{className:m}),l&&n.a.createElement("span",{className:Object(u.mapToCssModules)("sr-only",t)},l))};p.propTypes=g,p.defaultProps={tag:"div",type:"border",children:"Loading..."},s.a=p},504:function(e,s,t){"use strict";var a=t(13),o=t(18),r=t(0),n=t.n(r),c=t(4),i=t.n(c),l=t(52),d=t.n(l),u=t(74),g={tag:u.tagPropType,className:i.a.string,cssModule:i.a.object},p=function(e){var s=e.className,t=e.cssModule,r=e.tag,c=Object(o.a)(e,["className","cssModule","tag"]),i=Object(u.mapToCssModules)(d()(s,"card-text"),t);return n.a.createElement(r,Object(a.a)({},c,{className:i}))};p.propTypes=g,p.defaultProps={tag:"p"},s.a=p},577:function(e,s,t){"use strict";var a=t(0),o=t(52),r=t.n(o),n=t(1750),c=t(1749),i=t(463),l=t(1678),d=t(1680),u=t(1679),g=t(1319),p=t(5);const m=e=>{const{label:s,hideIcon:t,showIcon:o,visible:m,className:h,htmlFor:b,placeholder:j,iconSize:f,inputClassName:O,...v}=e,[w,x]=Object(a.useState)(m);return Object(p.jsxs)(a.Fragment,{children:[s?Object(p.jsx)(i.a,{for:b,children:s}):null,Object(p.jsxs)(l.a,{className:r()({[h]:h}),children:[Object(p.jsx)(d.a,{type:!1===w?"password":"text",placeholder:j||"\xb7\xb7\xb7\xb7\xb7\xb7\xb7\xb7\xb7\xb7\xb7\xb7",className:r()({[O]:O}),...s&&b?{id:b}:{},...v}),Object(p.jsx)(u.a,{addonType:"append",onClick:()=>x(!w),children:Object(p.jsx)(g.a,{className:"cursor-pointer",children:(()=>{const e=f||14;return!1===w?t||Object(p.jsx)(n.a,{size:e}):o||Object(p.jsx)(c.a,{size:e})})()})})]})]})};s.a=m,m.defaultProps={visible:!1}},803:function(e,s,t){"use strict";var a=t(75),o=t.n(a),r=t(788),n=t(503);const c=o.a.create();class i{constructor(e){this.jwtConfig={...r.a},this.isAlreadyFetchingAccessToken=!1,this.subscribers=[],this.jwtConfig={...this.jwtConfig,...e},console.log("jwtOverrideConfig ",e),c.interceptors.request.use((e=>{console.log("config ",e);const s=this.getToken();return e.headers.Authorization="".concat(this.jwtConfig.tokenType," ").concat(s),e}),(e=>Promise.reject(e))),c.interceptors.response.use((e=>e),(e=>{const{config:s,response:t}=e,a=s;if(t&&401===t.status){console.log("response.status ",t.status),this.isAlreadyFetchingAccessToken?window.location.replace("logout"):(this.isAlreadyFetchingAccessToken=!0,this.refreshToken().then((e=>{this.isAlreadyFetchingAccessToken=!1,this.setToken(e.data.jwtToken),this.onAccessTokenFetched(e.data.jwtToken)})));return new Promise((e=>{this.addSubscriber((s=>{a.headers.Authorization="".concat(this.jwtConfig.tokenType," ").concat(s),e(c(a))}))}))}return Promise.reject(e)}))}onAccessTokenFetched(e){this.subscribers=this.subscribers.filter((s=>s(e)))}addSubscriber(e){this.subscribers.push(e)}getToken(){return localStorage.getItem("BMStoken")||null}setToken(e){localStorage.setItem("BMStoken",e)}refreshToken(){return c.post(this.jwtConfig.getBMStoken,{username:n.f,password:n.d})}login(){return c.post(this.jwtConfig.getBMStoken,{username:n.f,password:n.d})}bmsDashboard(){return c.get(this.jwtConfig.bmsDashboardEndpoint)}getServiceList(){return c.get(this.jwtConfig.serviceListEndpoint)}campaignList(){return c.get("".concat(this.jwtConfig.campaignEndpoint))}}const{jwtBMS:l}={jwtBMS:new i({})};s.a=l}}]);
//# sourceMappingURL=282.1601ffbb.chunk.js.map