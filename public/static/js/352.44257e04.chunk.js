(this["webpackJsonprilac-web"]=this["webpackJsonprilac-web"]||[]).push([[352],{2588:function(e,t,a){"use strict";a.r(t);var s=a(0),c=a(1682),r=a(452),n=a(446),l=a(445),o=a(432),i=a(449),d=a(543),j=a(1692),b=a(1693),h=a(546),m=a(547),u=a(52),p=a.n(u),O=a(442),g=a(437),x=a(711),f=a(440),v=a(1750),y=a(1748),C=a(1822),N=a(1807),w=a(1753),S=a(450),k=a(451),L=a(463),_=a(1680),R=a(603),D=a(1957),A=a(1666),T=a(1677),W=a(651),z=a(443),P=a(444),B=a.n(P),I=a(460),E=a.n(I),M=a(5);const U=B()(E.a);var H=e=>{let{TableDataLoading:t,roleList:a,history:c,setRefresh:l,refresh:o}=e;const[d,j]=Object(s.useState)(""),[b,h]=Object(s.useState)([]),m=[{name:"Role Name",minWidth:"100px",sortable:!0,selector:"role_name"},{name:"Assign-user-count",minWidth:"100px",sortable:!0,selector:e=>e.users.length},{name:"Created By",minWidth:"100px",sortable:!0,selector:"created_by"},{name:"Created At",minWidth:"250px",sortable:!0,sortType:(e,t)=>new Date(t.created_at)-new Date(e.created_at),selector:e=>e.created_at?Object(z.b)(e.created_at):""},{name:"Action",minWidth:"150px",selector:e=>200===e.user_type?"Super Admin":Object(M.jsxs)(s.Fragment,{children:[Object(M.jsx)("span",{title:"View",children:Object(M.jsx)(v.a,{size:15,color:"dodgerblue",style:{cursor:"pointer"},onClick:()=>{c.push("/viewUserRole/".concat(e.id))}})}),"\xa0\xa0\xa0\xa0",Object(M.jsx)("span",{title:"Edit",children:Object(M.jsx)(y.a,{size:15,color:"blue",style:{cursor:"pointer"},onClick:t=>{c.push("/editUserRole/".concat(e.id))}})}),"\xa0\xa0\xa0\xa0",Object(M.jsx)("span",{title:"Delete",children:Object(M.jsx)(C.a,{size:15,color:"red",style:{cursor:"pointer"},onClick:t=>{var a,s;0===e.users.length?(a=e.id,s="Do you want to delete?",U.fire({title:"Are you sure?",text:s,icon:"warning",allowOutsideClick:!1,allowEscapeKey:!1,showCancelButton:!0,confirmButtonText:"Yes",customClass:{confirmButton:"btn btn-primary",cancelButton:"btn btn-danger ml-1"},showLoaderOnConfirm:!0,preConfirm:()=>O.a.deleteRole({role_id:a}).then((e=>{Object(g.c)(e),console.log(e),l(!o)})).catch((e=>{console.log(e.response),Object(g.a)(e)})),buttonsStyling:!1,allowOutsideClick:()=>!E.a.isLoading()}).then((function(e){e.isConfirmed}))):U.fire({title:"Delete assigned users first",icon:"warning",allowOutsideClick:!1,allowEscapeKey:!1,showCancelButton:!0,showConfirmButton:!1,customClass:{cancelButton:"btn btn-danger ml-1"},showLoaderOnConfirm:!1,buttonsStyling:!1}).then((function(e){e.isConfirmed}))}})})]})}];return Object(M.jsxs)(r.a,{children:[Object(M.jsx)(n.a,{children:Object(M.jsxs)(S.a,{style:{width:"100%"},children:[Object(M.jsxs)(k.a,{className:"d-flex align-items-center mt-1",sm:"6",children:[Object(M.jsx)(L.a,{className:"mr-1",for:"search-input",children:"Search"}),Object(M.jsx)(_.a,{style:{maxWidth:300},className:"dataTable-filter mb-50",type:"text",bsSize:"sm",id:"search-input",value:d,onChange:e=>{const t=e.target.value;let s=[];j(t),t.length&&(s=a.filter((e=>{var a,s;const c=null===(a=e.role_name)||void 0===a?void 0:a.toLowerCase().startsWith(t.toLowerCase()),r=null===(s=e.role_name)||void 0===s?void 0:s.toLowerCase().includes(t.toLowerCase());return c||(!c&&r?r:null)})),h(s),j(t))}})]}),Object(M.jsx)(k.a,{className:"d-flex align-items-center justify-content-end mt-1",sm:"6",children:Object(M.jsxs)(R.a,{className:"ml-1",children:[Object(M.jsxs)(D.a,{color:"secondary",caret:!0,outline:!0,children:[Object(M.jsx)(N.a,{size:15}),Object(M.jsx)("span",{className:"align-middle ml-50",children:"Export"})]}),Object(M.jsx)(A.a,{right:!0,children:Object(M.jsxs)(T.a,{className:"w-100",onClick:()=>Object(z.a)(a,Object.keys(a[0]||{}),"User Role"),children:[Object(M.jsx)(w.a,{size:15}),Object(M.jsx)("span",{className:"align-middle ml-50",children:"CSV"})]})})]})})]})}),Object(M.jsx)(i.a,{children:Object(M.jsx)(S.a,{children:Object(M.jsx)(k.a,{md:"12",children:Object(M.jsx)(W.a,{column:m,TableData:d.length?b:a,TableDataLoading:t})})})})]})},J=a(1716),V=a(532),Y=a(535),F=a(530),Z=a(549),q=a(467);var K=e=>{let{modal:t,toggleModal:a,roleInfo:c,setRefresh:d,refresh:j,action:b}=e;const[h,m]=Object(s.useState)(!0),[u,p]=Object(s.useState)([]),[x,f]=Object(s.useState)([]),[v,y]=Object(s.useState)([]),[C,N]=Object(s.useState)(!1);console.log(c),Object(s.useEffect)((()=>{c.id&&O.a.getApprovalEntryforRole(c.id).then((e=>{console.log(e);const t=[];for(const a of e.data.payload.module_data.roles){const s=e.data.payload.approved.find((e=>e.role_id===a.role_id));s?t.push({role_id:a.role_name,approved_by:s.approved_by,approved_at:s.approved_at}):t.push({role_id:a.role_name,approved_by:"--",approved_at:""})}y(t)})).catch((e=>{console.log(e),Object(g.a)(e)}))}),[c.id]);return Object(M.jsxs)(V.a,{size:"xl",isOpen:t,toggle:a,style:1===b?{border:"2px solid green"}:2===b?{border:"2px solid red"}:{},children:[Object(M.jsx)(Y.a,{toggle:a,children:1===b?"Approve Role":2===b?"Reject Role":"Role Details"}),Object(M.jsxs)(F.a,{children:[Object(M.jsx)(S.a,{children:Object(M.jsxs)(k.a,{sm:"12",children:[Object(M.jsxs)(r.a,{children:[Object(M.jsx)(n.a,{children:Object(M.jsx)(l.a,{children:"Approval Entry"})}),Object(M.jsx)(i.a,{children:Object(M.jsx)(S.a,{children:Object(M.jsx)(k.a,{sm:"12",children:Object(M.jsxs)(Z.a,{children:[Object(M.jsxs)("tr",{children:[Object(M.jsx)("th",{children:"Role Name"}),Object(M.jsx)("th",{children:"Approved By"}),Object(M.jsx)("th",{children:"Approved At"})]}),0!==(null===v||void 0===v?void 0:v.length)?null===v||void 0===v?void 0:v.map(((e,t)=>Object(M.jsxs)("tr",{children:[Object(M.jsx)("td",{children:e.role_id}),Object(M.jsx)("td",{children:e.approved_by}),Object(M.jsx)("td",{children:e.approved_at?Object(z.b)(e.approved_at||""):"--"})]},t))):Object(M.jsx)(q.a,{className:"text-center"})]})})})})]}),"`"]})}),Object(M.jsx)(S.a,{children:Object(M.jsx)(k.a,{sm:"12",className:"text-center",children:C?Object(M.jsxs)(o.a.Ripple,{color:"primary",className:"mr-1",disabled:!0,style:{marginTop:"25px"},children:[Object(M.jsx)(q.a,{color:"white",size:"sm"}),Object(M.jsx)("span",{className:"ml-50",children:"Loading..."})]}):Object(M.jsx)(o.a.Ripple,{className:"ml-2",color:"primary",onClick:()=>{N(!0),O.a.actionRole({id:c.id,action_id:b}).then((e=>{d(!j),Object(g.c)(e),N(!1),a(),console.log(e)})).catch((e=>{console.log(e.response),N(!1),a(),Object(g.a)(e)}))},type:"button",style:{marginTop:"25px"},children:Object(M.jsx)("span",{children:"Confirm"})})})})]})]})};B()(E.a);var $=e=>{let{TableDataLoading:t,roleList:a,history:c,setRefresh:l,refresh:o}=e;const[d,j]=Object(s.useState)(""),[b,h]=Object(s.useState)([]),m=JSON.parse(localStorage.getItem("userData")),[u,p]=Object(s.useState)(0),[O,g]=Object(s.useState)({}),[x,f]=Object(s.useState)(!1),y=[{name:"Role Name",minWidth:"100px",sortable:!0,selector:"role_name"},{name:"Assign-user-count",minWidth:"100px",sortable:!0,selector:e=>e.users.length},{name:"Created By",minWidth:"100px",sortable:!0,selector:"created_by"},{name:"Created At",minWidth:"250px",sortable:!0,sortType:(e,t)=>new Date(t.created_at)-new Date(e.created_at),selector:e=>e.created_at?Object(z.b)(e.created_at):""},{name:"Request Action",minWidth:"100px",sortable:!0,selector:"action"},{name:"Action",minWidth:"150px",selector:e=>m.id===e.created_by?"Pending (You created this.)":Object(M.jsxs)(M.Fragment,{children:[Object(M.jsx)("span",{title:"View",children:Object(M.jsx)(v.a,{size:15,color:"dodgerblue",style:{cursor:"pointer"},onClick:()=>{c.push("/viewUserPendingRole/".concat(e.id))}})}),"\xa0\xa0\xa0\xa0",Object(M.jsx)("span",{title:"Approve",children:Object(M.jsx)(J.a,{size:15,color:"dodgerblue",style:{cursor:"pointer"},onClick:()=>{g(e),f(!0),p(1)}})}),"\xa0\xa0\xa0\xa0",Object(M.jsx)("span",{title:"Reject",children:Object(M.jsx)(C.a,{size:15,color:"red",style:{cursor:"pointer"},onClick:()=>{g(e),f(!0),p(2)}})})]})}];return Object(M.jsxs)(r.a,{children:[Object(M.jsx)(n.a,{children:Object(M.jsxs)(S.a,{style:{width:"100%"},children:[Object(M.jsxs)(k.a,{className:"d-flex align-items-center mt-1",sm:"6",children:[Object(M.jsx)(L.a,{className:"mr-1",for:"search-input",children:"Search"}),Object(M.jsx)(_.a,{style:{maxWidth:300},className:"dataTable-filter mb-50",type:"text",bsSize:"sm",id:"search-input",value:d,onChange:e=>{const t=e.target.value;let s=[];j(t),t.length&&(s=a.filter((e=>{var a,s;const c=null===(a=e.role_name)||void 0===a?void 0:a.toLowerCase().startsWith(t.toLowerCase()),r=null===(s=e.role_name)||void 0===s?void 0:s.toLowerCase().includes(t.toLowerCase());return c||(!c&&r?r:null)})),h(s),j(t))}})]}),Object(M.jsx)(k.a,{className:"d-flex align-items-center justify-content-end mt-1",sm:"6",children:Object(M.jsxs)(R.a,{className:"ml-1",children:[Object(M.jsxs)(D.a,{color:"secondary",caret:!0,outline:!0,children:[Object(M.jsx)(N.a,{size:15}),Object(M.jsx)("span",{className:"align-middle ml-50",children:"Export"})]}),Object(M.jsx)(A.a,{right:!0,children:Object(M.jsxs)(T.a,{className:"w-100",onClick:()=>Object(z.a)(a,Object.keys(a[0]||{}),"User Role"),children:[Object(M.jsx)(w.a,{size:15}),Object(M.jsx)("span",{className:"align-middle ml-50",children:"CSV"})]})})]})})]})}),Object(M.jsx)(i.a,{children:Object(M.jsx)(S.a,{children:Object(M.jsx)(k.a,{md:"12",children:Object(M.jsx)(W.a,{column:y,TableData:d.length?b:a,TableDataLoading:t})})})}),Object(M.jsx)(K,{modal:x,toggleModal:()=>f(!x),roleInfo:O,refresh:o,setRefresh:l,action:u})]})};B()(E.a);var G=e=>{let{TableDataLoading:t,roleList:a,history:c}=e;const[l,o]=Object(s.useState)(""),[d,j]=Object(s.useState)([]),b=(JSON.parse(localStorage.getItem("userData")),[{name:"Role Name",minWidth:"100px",sortable:!0,selector:"role_name"},{name:"Assign-user-count",minWidth:"100px",sortable:!0,selector:e=>e.users.length},{name:"Request Action",minWidth:"100px",sortable:!0,selector:"action"},{name:"Created At",minWidth:"250px",sortable:!0,sortType:(e,t)=>new Date(t.created_at)-new Date(e.created_at),selector:e=>e.created_at?Object(z.b)(e.created_at):""},{name:"Action",minWidth:"150px",selector:e=>Object(M.jsx)("span",{title:"View",children:Object(M.jsx)(v.a,{size:15,color:"dodgerblue",style:{cursor:"pointer"},onClick:()=>{c.push("/viewUserPendingRole/".concat(e.id))}})})}]);return Object(M.jsxs)(r.a,{children:[Object(M.jsx)(n.a,{children:Object(M.jsxs)(S.a,{style:{width:"100%"},children:[Object(M.jsxs)(k.a,{className:"d-flex align-items-center mt-1",sm:"6",children:[Object(M.jsx)(L.a,{className:"mr-1",for:"search-input",children:"Search"}),Object(M.jsx)(_.a,{style:{maxWidth:300},className:"dataTable-filter mb-50",type:"text",bsSize:"sm",id:"search-input",value:l,onChange:e=>{const t=e.target.value;let s=[];o(t),t.length&&(s=a.filter((e=>{var a,s;const c=null===(a=e.role_name)||void 0===a?void 0:a.toLowerCase().startsWith(t.toLowerCase()),r=null===(s=e.role_name)||void 0===s?void 0:s.toLowerCase().includes(t.toLowerCase());return c||(!c&&r?r:null)})),j(s),o(t))}})]}),Object(M.jsx)(k.a,{className:"d-flex align-items-center justify-content-end mt-1",sm:"6",children:Object(M.jsxs)(R.a,{className:"ml-1",children:[Object(M.jsxs)(D.a,{color:"secondary",caret:!0,outline:!0,children:[Object(M.jsx)(N.a,{size:15}),Object(M.jsx)("span",{className:"align-middle ml-50",children:"Export"})]}),Object(M.jsx)(A.a,{right:!0,children:Object(M.jsxs)(T.a,{className:"w-100",onClick:()=>Object(z.a)(a,Object.keys(a[0]||{}),"User Role"),children:[Object(M.jsx)(w.a,{size:15}),Object(M.jsx)("span",{className:"align-middle ml-50",children:"CSV"})]})})]})})]})}),Object(M.jsx)(i.a,{children:Object(M.jsx)(S.a,{children:Object(M.jsx)(k.a,{md:"12",children:Object(M.jsx)(W.a,{column:b,TableData:l.length?d:a,TableDataLoading:t})})})})]})};t.default=()=>{const e=(JSON.parse(localStorage.getItem("AssignedMenus"))||[]).map((e=>e.submenu.map((e=>e.id)))),t=[].concat(...e),a=Object(x.g)(),[u,v]=Object(s.useState)([]),[y,C]=Object(s.useState)([]),[N,w]=Object(s.useState)([]),[S,k]=Object(s.useState)(!0),[L,_]=Object(s.useState)(!1),[R,D]=Object(s.useState)("1"),A=e=>{R!==e&&D(e)};return Object(s.useEffect)((()=>{localStorage.setItem("useBMStoken",!1),localStorage.setItem("usePMStoken",!1),O.a.roleList().then((e=>{console.log("roleList",e.data.payload),v(e.data.payload.List),C(e.data.payload.PendingList),w(e.data.payload.MyPendingList),k(!1)})).catch((e=>{Object(g.a)(e),console.log(e),k(!1)}))}),[L]),Object(M.jsxs)(s.Fragment,{children:[Object(M.jsxs)(r.a,{children:[Object(M.jsxs)(n.a,{className:"border-bottom",children:[Object(M.jsx)(l.a,{tag:"h4",children:"User Role"}),Object(M.jsx)("div",{children:t.includes(69)&&Object(M.jsx)(o.a.Ripple,{className:"ml-2",color:"primary",tag:f.b,to:"/createUserRole",children:Object(M.jsxs)("div",{className:"d-flex align-items-center",children:[Object(M.jsx)(c.a,{size:17,style:{marginRight:"5px"}}),Object(M.jsx)("span",{children:"Create User Role"})]})})})]}),Object(M.jsx)(i.a,{children:Object(M.jsxs)(d.a,{tabs:!0,children:[Object(M.jsx)(j.a,{children:Object(M.jsx)(b.a,{className:p()({active:"1"===R}),onClick:()=>{A("1")},children:" Role List"})}),Object(M.jsx)(j.a,{children:Object(M.jsx)(b.a,{className:p()({active:"2"===R}),onClick:()=>{A("2")},children:" My Pending"})}),t.includes(72)&&Object(M.jsx)(j.a,{children:Object(M.jsx)(b.a,{className:p()({active:"3"===R}),onClick:()=>{A("3")},children:" Approve Role"})})]})})]}),Object(M.jsx)(r.a,{children:Object(M.jsxs)(h.a,{activeTab:R,children:[Object(M.jsx)(m.a,{tabId:"1",children:Object(M.jsx)(H,{TableDataLoading:S,roleList:u,history:a,setRefresh:_,refresh:L})}),Object(M.jsx)(m.a,{tabId:"2",children:Object(M.jsx)(G,{TableDataLoading:S,roleList:N,history:a})}),Object(M.jsx)(m.a,{tabId:"3",children:Object(M.jsx)($,{TableDataLoading:S,roleList:y,history:a,setRefresh:_,refresh:L})})]})})]})}},437:function(e,t,a){"use strict";a.d(t,"a",(function(){return c})),a.d(t,"b",(function(){return r})),a.d(t,"c",(function(){return n}));a(0);var s=a(107);const c=e=>{try{const t=e.response;404===t.status||401===t.status||400===t.status||500===t.status||409===t.status?s.f.error(t.data.message,{position:"top-right",autoClose:5e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0}):s.f.error("The server is under maintenance",{position:"top-right",autoClose:5e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0})}catch(t){s.f.error("Please check your connection",{position:"top-right",autoClose:5e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0})}},r=e=>{try{const t=e.response;404!==t.status&&401!==t.status&&400!==t.status||s.f.error(t.data.errors?t.data.errors[Object.keys(t.data.errors)[0]]:t.data.message,{position:"top-right",autoClose:5e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0})}catch(t){s.f.error("Please check your connection",{position:"top-right",autoClose:5e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0})}},n=e=>{const t=e.data.message||"success";s.f.success(t,{position:"top-right",autoClose:5e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0})}},443:function(e,t,a){"use strict";a.d(t,"b",(function(){return n})),a.d(t,"c",(function(){return l})),a.d(t,"f",(function(){return o})),a.d(t,"e",(function(){return i})),a.d(t,"d",(function(){return d})),a.d(t,"a",(function(){return j}));var s=a(486),c=a.n(s);const r={year:"numeric",month:"long",day:"numeric",hour:"numeric",minute:"numeric"},n=e=>new Date(e).toLocaleDateString(void 0,r),l=e=>{e.endsWith("Z")&&(e=e.slice(0,-1));const t=e.indexOf("+");return-1!==t&&(e=e.slice(0,t)),c()(e).format("MMMM D, YYYY [at] h:mm A")},o=e=>String(e).toLowerCase().match(/^(([^<>()[\]\\.,;:\s@"]+(\.[^<>()[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/),i=e=>e.toString().replace(/\B(?=(\d{3})+(?!\d))/g,","),d=async e=>{401===e&&(window.location.href="/Adminlogin",await localStorage.clear())},j=(e,t,a)=>{const s=document.createElement("a");let c=function(e){let a;return a="",a+=t.join(","),a+="\n",e.forEach((e=>{let s=0;t.forEach((t=>{s>0&&(a+=","),a+=e[t],s++})),a+="\n"})),a}(e);if(null===c)return;const r=JSON.parse(localStorage.getItem("userData")),n="".concat(a,"_").concat((new Date).toISOString(),"_").concat(r.fullname.replaceAll(/\s/g,""),".csv");c.match(/^data:text\/csv/i)||(c="data:text/csv;charset=utf-8,".concat(c)),s.setAttribute("href",encodeURI(c)),s.setAttribute("download",n),s.click()}},651:function(e,t,a){"use strict";var s=a(0),c=a(1719),r=a(467),n=a(471),l=a.n(n),o=a(474),i=a.n(o),d=a(5);t.a=e=>{let{column:t,TableData:a,TableDataLoading:n}=e;const[o,j]=Object(s.useState)(0);return Object(d.jsx)(s.Fragment,{children:Object(d.jsx)(i.a,{noHeader:!0,pagination:!0,columns:t,paginationPerPage:10,className:"react-dataTable",sortIcon:Object(d.jsx)(c.a,{size:10}),paginationDefaultPage:o+1,paginationComponent:()=>Object(d.jsx)(l.a,{previousLabel:"",nextLabel:"",forcePage:o,onPageChange:e=>(e=>{j(e.selected)})(e),pageCount:a.length?a.length/10:1,breakLabel:"...",pageRangeDisplayed:2,marginPagesDisplayed:2,activeClassName:"active",pageClassName:"page-item",breakClassName:"page-item",breakLinkClassName:"page-link",nextLinkClassName:"page-link",nextClassName:"page-item next",previousClassName:"page-item prev",previousLinkClassName:"page-link",pageLinkClassName:"page-link",breakClassName:"page-item",breakLinkClassName:"page-link",containerClassName:"pagination react-paginate separated-pagination pagination-sm justify-content-end pr-1 mt-1"}),data:a,progressPending:n,progressComponent:Object(d.jsx)(r.a,{color:"primary"}),responsive:!0})})}}}]);
//# sourceMappingURL=352.44257e04.chunk.js.map